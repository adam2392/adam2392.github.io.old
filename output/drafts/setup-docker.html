<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Adam Li's blog</title>
	<meta name="description" content="">
	<meta name="author" content="Adam Li">

	<!-- HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
		<script src="https://adam2392.github.io/theme/html5.js"></script>
	<![endif]-->

	<!-- Styles -->
	<link href="https://adam2392.github.io/theme/bootstrap.min.css" rel="stylesheet">
	<link href="https://adam2392.github.io/theme/local.css" rel="stylesheet">
	<link href="https://adam2392.github.io/theme/pygments.css" rel="stylesheet">

	<!-- Feeds -->
	<link href="https://adam2392.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Adam Li's blog Atom Feed" />


	<link href="https://adam2392.github.io/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Adam Li's blog RSS Feed" />


<script>var _gaq=[['_setAccount','UA-106551801-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>
</head>
<body>
<a href="https://github.com/adam2392"><img style="position: absolute; top: 39px; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png" alt="Fork me on GitHub" /></a>
	<div class="topbar">
	  <div class="topbar-inner">
		<div class="container-fluid">
		  <a class="brand" href="https://adam2392.github.io/">Adam Li's blog</a>
			<ul class="nav">
					<li><a href="/categories.html">Blog</a></li>
					<li><a href="/archives.html">Timeline</a></li>
					<li><a href="/tags.html">Tags</a></li>
					<li><a href="/pdfs/AdamLi_CV.pdf">Curriculum Vitae</a></li>
						<li><a href="https://adam2392.github.io/contact/">Contact</a></li>
					<li ><a href="https://adam2392.github.io/category/academic.html">Academic</a></li>
					<li class="active"><a href="https://adam2392.github.io/category/coding.html">Coding</a></li>
					<li ><a href="https://adam2392.github.io/category/machine-learning.html">Machine Learning</a></li>
					<li ><a href="https://adam2392.github.io/category/personal.html">Personal</a></li>
					<li ><a href="https://adam2392.github.io/category/travel.html">Travel</a></li>
					<li ><a href="https://adam2392.github.io/category/views.html">Views</a></li>
			</ul>
			<p class="pull-right"><a href="https://adam2392.github.io/archives.html">[archives]</a> <a href="https://adam2392.github.io/tags.html">[tags]</a></p>
		</div>
	  </div>
	</div>

	<div class="container-fluid">
	  <div class="sidebar">
		<div class="well">
			<h3>Blogroll</h3>
			<ul>
				<li><a href="http://getpelican.com/">Pelican</a></li>
				<li><a href="http://python.org/">Python.org</a></li>
				<li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
				<li><a href="#">You can modify those links in your config file</a></li>
			</ul>
			<div class="social">
			<h3>Social</h3>
			<ul>
				<li><a href="https://twitter.com/adam2392">twitter</a></li>
				<li><a href="https://stackexchange.com/users/4494355/ajl123">stack-overflow</a></li>
				<li><a href="https://github.com/adam2392">github</a></li>
				<li><a href="https://www.linkedin.com/in/adam2392">linkedin</a></li>
			</ul>
			</div>
		</div>
	  </div>
	  <div class="content">
	<div class='article'>
		<div class="page-header"><h1>Setting Up Docker</h1></div>
		<div class="well small">Permalink: <a class="more" href="https://adam2392.github.io/drafts/setup-docker.html">2018-06-17 00:00:00-04:00</a>
by <a class="url fn" href="https://adam2392.github.io/author/adam-li.html">Adam Li </a>
 in <a href="https://adam2392.github.io/category/coding.html">Coding</a>
tags: <a href="https://adam2392.github.io/tag/webdev.html">webdev</a> <a href="https://adam2392.github.io/tag/docker.html">docker</a> <a href="https://adam2392.github.io/tag/macos.html">macos</a> </div>
		<div><h1>Getting Setup on Using Docker</h1>
<h1>By: Adam Li</h1>
<h3>Table of Contents</h3>
<!-- MarkdownTOC -->

<ul>
<li>Installation</li>
<li>Setting Hardware Requirements:</li>
<li>Using Docker<ul>
<li>
<ol>
<li>Docker Image</li>
<li>1a. Setting Base Docker Volume</li>
<li>1b. Creating The Container</li>
<li>1c. Running PostgreSQL via Container</li>
<li>1d. (Optional) Expose Docker Container To Host</li>
</ol>
</li>
<li>2.</li>
</ul>
</li>
<li>Linking All This With Docker-Compose<ul>
<li>1.</li>
</ul>
</li>
<li>Common Commands<ul>
<li>Images</li>
<li>Containers</li>
<li>Volumes</li>
</ul>
</li>
<li>Testing<ul>
<li>1.</li>
<li>2.</li>
</ul>
</li>
<li>References:</li>
</ul>
<!-- /MarkdownTOC -->

<h1>Installation</h1>
<p>The following packages need to be installed for a test time environment:</p>
<div class="highlight"><pre><span></span><span class="n">brew</span> <span class="k">update</span>
<span class="n">brew</span> <span class="n">prune</span>
<span class="n">brew</span> <span class="n">doctor</span>
<span class="n">brew</span> <span class="n">install</span> <span class="n">postgres</span>
<span class="n">brew</span> <span class="n">install</span> <span class="n">docker</span>
</pre></div>


<h1>Setting Hardware Requirements:</h1>
<p>Some packages need minimum hardware requirements assigned to Docker usage.</p>
<p>A minimum of 4GB RAM assigned to Docker</p>
<p>Elasticsearch alone needs at least 2GB of RAM to run.</p>
<p>With Docker for Mac, the amount of RAM dedicated to Docker can be set using the UI: see How to increase docker-machine memory Mac (Stack Overflow).</p>
<h1>Using Docker</h1>
<h2>1. Docker Image</h2>
<p>Most docker images have been prebuilt and tested online. Containers are these dynamic "images" of your system that will host data, programs, etc. Images are snapshots of those containers (mainly at the beginning) to setup the baseline container. </p>
<p>Volumes are a way of allowing containers persistent storage across usage.</p>
<h3>1a. Setting Base Docker Volume</h3>
<p>This will create a docker with a volume (in the docker image) at the volume you specify with the "-v" tag. The docker image has the name that you set, and then it is based off of "busybox", which is a generalized light-weight docker image by Docker.</p>
<div class="highlight"><pre><span></span><span class="n">docker</span> <span class="k">create</span> <span class="o">-</span><span class="n">v</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="k">data</span> <span class="c1">--name postgres10.4-data busybox</span>
</pre></div>


<h3>1b. Creating The Container</h3>
<div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="c1">--name local-postgres10.4 -e POSTGRES_PASSWORD=dappstore -d --volumes-from postgres10.4-data postgres:10.4</span>
</pre></div>


<h3>1c. Running PostgreSQL via Container</h3>
<div class="highlight"><pre><span></span><span class="nv">docker</span> <span class="nv">run</span> <span class="o">-</span><span class="nv">it</span> <span class="o">--</span><span class="nv">link</span> <span class="nv">local</span><span class="o">-</span><span class="nv">postgres10</span>.<span class="mi">4</span>:<span class="nv">postgres</span> <span class="o">--</span><span class="nv">rm</span> <span class="nv">postgres</span>:<span class="mi">10</span>.<span class="mi">4</span> <span class="nv">sh</span> <span class="o">-</span><span class="nv">c</span> <span class="s1">&#39;</span><span class="s">exec psql -h &quot;$POSTGRES_PORT_5432_TCP_ADDR&quot; -p &quot;$POSTGRES_PORT_5432_TCP_PORT&quot; -U postgres</span><span class="s1">&#39;</span>
</pre></div>


<p>Enter the password you just set.</p>
<p>Inside, you can modify and begin the basic configuration of the base container volume by creating tables and initializing roles using SQL.</p>
<p>Now, your base container is set up! Don't remove this if you want to have persistant Postgresql set up.</p>
<h3>1d. (Optional) Expose Docker Container To Host</h3>
<div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="c1">--name local-postgres10.4 -p 5432:5432 -e POSTGRES_PASSWORD=asecurepassword -d --volumes-from postgres10.4-data postgres:10.4</span>
</pre></div>


<p>This will expose the PostGRESQL docker instance via port 5432 localhost, so that you can connect to it via any application now.</p>
<h2>2.</h2>
<h1>Linking All This With Docker-Compose</h1>
<p>Docker-compose is a way of composing up the docker images that you have in a way that fits your needs. You can modularly stack docker images and then run additional installations that fit your specifications.</p>
<p>So, for example, here we will compose a docker image that is composed of django, postgres and elasticsearch to have a fully functional web-app with logging capabilities. (Perhaps we should also think about adding Kibana and Logstash for a full ELK stack)?</p>
<h2>1.</h2>
<p>Refer to https://medium.com/@leo_hetsch/local-development-with-go-postgresql-and-elasticsearch-in-docker-61bc8a0d5e66 for a nice little explanation for some common docker installation commands for postgresql and elastic search.</p>
<div class="highlight"><pre><span></span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">-</span><span class="n">f</span> <span class="k">local</span><span class="p">.</span><span class="n">yml</span> <span class="n">build</span>
</pre></div>


<p>or </p>
<div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">COMPOSE_FILE</span><span class="o">=</span><span class="k">local</span><span class="p">.</span><span class="n">yml</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">up</span>
</pre></div>


<p>Possible / common methods:</p>
<div class="highlight"><pre><span></span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">-</span><span class="n">f</span> <span class="k">local</span><span class="p">.</span><span class="n">yml</span> <span class="n">run</span> <span class="c1">--rm django python manage.py migrate</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">-</span><span class="n">f</span> <span class="k">local</span><span class="p">.</span><span class="n">yml</span> <span class="n">run</span> <span class="c1">--rm django python manage.py createsuperuser</span>
</pre></div>


<p>Since docker is composed of a set of build commands, you should read up on the documentation here:</p>
<p>https://docs.docker.com/compose/compose-file/#resources</p>
<h1>Common Commands</h1>
<h2>Images</h2>
<div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">image</span> <span class="n">ls</span>
<span class="n">docker</span> <span class="n">ps</span>

<span class="n">docker</span> <span class="n">rmi</span> <span class="o">&lt;</span><span class="n">image_name</span><span class="o">&gt;</span>
</pre></div>


<h2>Containers</h2>
<div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">container</span> <span class="n">ls</span>
</pre></div>


<h2>Volumes</h2>
<h1>Testing</h1>
<h2>1.</h2>
<h2>2.</h2>
<h1>References:</h1>
<ol>
<li>http://boot2docker.io/</li>
<li>https://ryaneschinger.com/blog/dockerized-postgresql-development-environment/</li>
<li></li>
</ol></div>
		<div>
			<h2>Comments</h2>
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="adam2392">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
		<div>
	</div>
		<footer>
		  <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme based on <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap</a>.</p>
		  <p>&copy; Adam Li</p>
		</footer>
	  </div>

	</div>
</body>
</html>