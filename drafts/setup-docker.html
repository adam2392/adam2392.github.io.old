<!DOCTYPE html>
<html lang="en">
<head>
          <title>Adam Li's blog - Setting Up Docker</title>
        <meta charset="utf-8" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Adam Li's blog Full Atom Feed" />
        <link href="/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Adam Li's blog Full RSS Feed" />
        <link href="/feeds/coding.atom.xml" type="application/atom+xml" rel="alternate" title="Adam Li's blog Categories Atom Feed" />




    <meta name="tags" content="webdev" />
    <meta name="tags" content="docker" />
    <meta name="tags" content="macos" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Adam Li's blog <strong></strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/categories.html">Blog</a></li>
            <li><a href="/archives.html">Timeline</a></li>
            <li><a href="/tags.html">Tags</a></li>
            <li><a href="/pdfs/AdamLi_CV.pdf">Curriculum Vitae</a></li>
            <li><a href="/contact/">Contact</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="/drafts/setup-docker.html" rel="bookmark"
         title="Permalink to Setting Up Docker">Setting Up Docker</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2018-06-17T00:00:00-04:00">
      Sun 17 June 2018
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="/author/adam-li.html">Adam Li</a>
    </address>
    <div class="category">
        Category: <a href="/category/coding.html">Coding</a>
    </div>
    <div class="tags">
        Tags:
            <a href="/tag/webdev.html">webdev</a>
            <a href="/tag/docker.html">docker</a>
            <a href="/tag/macos.html">macos</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <h1>Getting Setup on Using Docker</h1>
<h1>By: Adam Li</h1>
<h3>Table of Contents</h3>
<!-- MarkdownTOC -->

<ul>
<li>Installation</li>
<li>Setting Hardware Requirements:</li>
<li>Using Docker<ul>
<li>
<ol>
<li>Docker Image</li>
<li>1a. Setting Base Docker Volume</li>
<li>1b. Creating The Container</li>
<li>1c. Running PostgreSQL via Container</li>
<li>1d. (Optional) Expose Docker Container To Host</li>
</ol>
</li>
<li>2.</li>
</ul>
</li>
<li>Linking All This With Docker-Compose<ul>
<li>1.</li>
</ul>
</li>
<li>Common Commands<ul>
<li>Images</li>
<li>Containers</li>
<li>Volumes</li>
</ul>
</li>
<li>Testing<ul>
<li>1.</li>
<li>2.</li>
</ul>
</li>
<li>References:</li>
</ul>
<!-- /MarkdownTOC -->

<h1>Installation</h1>
<p>The following packages need to be installed for a test time environment:</p>
<div class="highlight"><pre><span></span><span class="n">brew</span> <span class="k">update</span>
<span class="n">brew</span> <span class="n">prune</span>
<span class="n">brew</span> <span class="n">doctor</span>
<span class="n">brew</span> <span class="n">install</span> <span class="n">postgres</span>
<span class="n">brew</span> <span class="n">install</span> <span class="n">docker</span>
</pre></div>


<h1>Setting Hardware Requirements:</h1>
<p>Some packages need minimum hardware requirements assigned to Docker usage.</p>
<p>A minimum of 4GB RAM assigned to Docker</p>
<p>Elasticsearch alone needs at least 2GB of RAM to run.</p>
<p>With Docker for Mac, the amount of RAM dedicated to Docker can be set using the UI: see How to increase docker-machine memory Mac (Stack Overflow).</p>
<h1>Using Docker</h1>
<h2>1. Docker Image</h2>
<p>Most docker images have been prebuilt and tested online. Containers are these dynamic "images" of your system that will host data, programs, etc. Images are snapshots of those containers (mainly at the beginning) to setup the baseline container. </p>
<p>Volumes are a way of allowing containers persistent storage across usage.</p>
<h3>1a. Setting Base Docker Volume</h3>
<p>This will create a docker with a volume (in the docker image) at the volume you specify with the "-v" tag. The docker image has the name that you set, and then it is based off of "busybox", which is a generalized light-weight docker image by Docker.</p>
<div class="highlight"><pre><span></span><span class="n">docker</span> <span class="k">create</span> <span class="o">-</span><span class="n">v</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="k">data</span> <span class="c1">--name postgres10.4-data busybox</span>
</pre></div>


<h3>1b. Creating The Container</h3>
<div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="c1">--name local-postgres10.4 -e POSTGRES_PASSWORD=dappstore -d --volumes-from postgres10.4-data postgres:10.4</span>
</pre></div>


<h3>1c. Running PostgreSQL via Container</h3>
<div class="highlight"><pre><span></span><span class="nv">docker</span> <span class="nv">run</span> <span class="o">-</span><span class="nv">it</span> <span class="o">--</span><span class="nv">link</span> <span class="nv">local</span><span class="o">-</span><span class="nv">postgres10</span>.<span class="mi">4</span>:<span class="nv">postgres</span> <span class="o">--</span><span class="nv">rm</span> <span class="nv">postgres</span>:<span class="mi">10</span>.<span class="mi">4</span> <span class="nv">sh</span> <span class="o">-</span><span class="nv">c</span> <span class="s1">&#39;</span><span class="s">exec psql -h &quot;$POSTGRES_PORT_5432_TCP_ADDR&quot; -p &quot;$POSTGRES_PORT_5432_TCP_PORT&quot; -U postgres</span><span class="s1">&#39;</span>
</pre></div>


<p>Enter the password you just set.</p>
<p>Inside, you can modify and begin the basic configuration of the base container volume by creating tables and initializing roles using SQL.</p>
<p>Now, your base container is set up! Don't remove this if you want to have persistant Postgresql set up.</p>
<h3>1d. (Optional) Expose Docker Container To Host</h3>
<div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="c1">--name local-postgres10.4 -p 5432:5432 -e POSTGRES_PASSWORD=asecurepassword -d --volumes-from postgres10.4-data postgres:10.4</span>
</pre></div>


<p>This will expose the PostGRESQL docker instance via port 5432 localhost, so that you can connect to it via any application now.</p>
<h2>2.</h2>
<h1>Linking All This With Docker-Compose</h1>
<p>Docker-compose is a way of composing up the docker images that you have in a way that fits your needs. You can modularly stack docker images and then run additional installations that fit your specifications.</p>
<p>So, for example, here we will compose a docker image that is composed of django, postgres and elasticsearch to have a fully functional web-app with logging capabilities. (Perhaps we should also think about adding Kibana and Logstash for a full ELK stack)?</p>
<h2>1.</h2>
<p>Refer to https://medium.com/@leo_hetsch/local-development-with-go-postgresql-and-elasticsearch-in-docker-61bc8a0d5e66 for a nice little explanation for some common docker installation commands for postgresql and elastic search.</p>
<div class="highlight"><pre><span></span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">-</span><span class="n">f</span> <span class="k">local</span><span class="p">.</span><span class="n">yml</span> <span class="n">build</span>
</pre></div>


<p>or </p>
<div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">COMPOSE_FILE</span><span class="o">=</span><span class="k">local</span><span class="p">.</span><span class="n">yml</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">up</span>
</pre></div>


<p>Possible / common methods:</p>
<div class="highlight"><pre><span></span><span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">-</span><span class="n">f</span> <span class="k">local</span><span class="p">.</span><span class="n">yml</span> <span class="n">run</span> <span class="c1">--rm django python manage.py migrate</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">-</span><span class="n">f</span> <span class="k">local</span><span class="p">.</span><span class="n">yml</span> <span class="n">run</span> <span class="c1">--rm django python manage.py createsuperuser</span>
</pre></div>


<p>Since docker is composed of a set of build commands, you should read up on the documentation here:</p>
<p>https://docs.docker.com/compose/compose-file/#resources</p>
<h1>Common Commands</h1>
<h2>Images</h2>
<div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">image</span> <span class="n">ls</span>
<span class="n">docker</span> <span class="n">ps</span>

<span class="n">docker</span> <span class="n">rmi</span> <span class="o">&lt;</span><span class="n">image_name</span><span class="o">&gt;</span>
</pre></div>


<h2>Containers</h2>
<div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">container</span> <span class="n">ls</span>
</pre></div>


<h2>Volumes</h2>
<h1>Testing</h1>
<h2>1.</h2>
<h2>2.</h2>
<h1>References:</h1>
<ol>
<li>http://boot2docker.io/</li>
<li>https://ryaneschinger.com/blog/dockerized-postgresql-development-environment/</li>
<li></li>
</ol>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>